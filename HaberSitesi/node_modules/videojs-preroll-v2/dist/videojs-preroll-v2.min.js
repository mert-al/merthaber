/*! @name videojs-preroll-v2 @version 2.0.0 @license MIT */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("video.js"),require("global/window")):"function"==typeof define&&define.amd?define(["video.js","global/window"],r):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsPrerollV2=r(e.videojs,e.window)}(this,(function(e,r){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=o(e),n=o(r),i={src:"",href:"",target:"_blank",allowSkip:!0,skipTime:5,repeatAd:!1,adSign:!1,showRemaining:!1,adsOptions:{},lang:{skip:"Skip Ad &#8811;","skip in":"Skip in ",advertisement:"Advertisement","video start in":"Video will start in: "}},t=l.default.registerPlugin||l.default.plugin,a=function(e){!function(e,r){e.addClass("vjs-preroll"),e.preroll={adDone:!1,options:r},e.ads(e.preroll.options.adsOptions),e.on("contentupdate",(function(){e.preroll.shouldPlayPreroll()?e.trigger("adsready"):e.trigger("adscanceled")})),e.on("readyforpreroll",(function(){if(e.preroll.shouldPlayPreroll()){e.ads.startLinearAdMode(),e.bigPlayButton.hide(),e.controlBar.playbackRateMenuButton.hide();var r=l.default.VERSION.split("."),o=parseInt(r[0],10);if(o<=5?n.default.document.querySelector(".vjs-progress-control").style.pointerEvents="none":o>=6&&e.controlBar.progressControl.disable(),e.contentSrc=e.preroll.options.src,e.src(e.preroll.options.src),e.one("durationchange",(function(){e.play()})),e.one("progress",(function(){e.play()})),e.one("adloadstart",(function(){e.play()})),""!==e.preroll.options.href){var i=n.default.document.createElement("a");i.className="preroll-blocker",i.href=e.preroll.options.href,i.target=e.preroll.options.target||"_blank",i.onclick=function(){e.trigger("adclick")},e.preroll.blocker=i,e.el().insertBefore(i,e.controlBar.el())}if(!1!==e.preroll.options.adSign){var t=n.default.document.createElement("div");t.className="advertisement-box",e.preroll.adBox=t,e.el().appendChild(t),e.preroll.adBox.innerHTML=e.preroll.options.lang.advertisement}if(!1!==e.preroll.options.showRemaining&&!1===e.preroll.options.allowSkip){var a=n.default.document.createElement("div");a.className="remaining-time",e.preroll.remainingTime=a,e.el().appendChild(a),e.preroll.remainingTime.innerHTML=e.preroll.options.lang["video start in"],e.on("adtimeupdate",e.preroll.timeremaining)}if(!1!==e.preroll.options.allowSkip){var p=n.default.document.createElement("div");p.className="preroll-skip-button",e.preroll.skipButton=p,e.el().appendChild(p),p.onclick=function(r){var o=n.default.Event;if((" "+e.preroll.skipButton.className+" ").indexOf(" enabled ")>=0&&e.preroll.exitPreroll(),void 0===o.prototype.stopPropagation)return!1;r.stopPropagation()},e.on("adtimeupdate",e.preroll.timeupdate)}e.one("adended",e.preroll.exitPreroll),e.one("error",e.preroll.prerollError)}else e.trigger("adscanceled")})),e.preroll.shouldPlayPreroll=function(){return""!==e.preroll.options.src&&!0!==e.preroll.adDone},e.preroll.exitPreroll=function(){void 0!==e.preroll.skipButton&&e.preroll.skipButton.parentNode.removeChild(e.preroll.skipButton),void 0!==e.preroll.adBox&&e.preroll.adBox.parentNode.removeChild(e.preroll.adBox),void 0!==e.preroll.remainingTime&&e.preroll.remainingTime.parentNode.removeChild(e.preroll.remainingTime),void 0!==e.preroll.blocker&&e.preroll.blocker.parentNode.removeChild(e.preroll.blocker),e.off("adended",e.preroll.exitPreroll),e.off("error",e.preroll.prerollError),!0!==e.preroll.options.repeatAd&&(e.preroll.adDone=!0),e.loadingSpinner.show(),e.posterImage.hide(),e.bigPlayButton.show(),e.controlBar.playbackRateMenuButton.show(),e.controlBar.progressControl.enable(),e.ads.endLinearAdMode()},e.preroll.timeupdate=function(r){e.loadingSpinner.hide();var o=Math.ceil(e.preroll.options.skipTime-e.currentTime());o>0?e.preroll.skipButton.innerHTML=e.preroll.options.lang["skip in"]+o+"s":-1===(" "+e.preroll.skipButton.className+" ").indexOf(" enabled ")&&(e.preroll.skipButton.className+=" enabled",e.preroll.skipButton.innerHTML=e.preroll.options.lang.skip)},e.preroll.timeremaining=function(r){e.loadingSpinner.hide();var o=Math.ceil(e.remainingTime());o>0&&(e.preroll.remainingTime.innerHTML=e.preroll.options.lang["video start in"]+o+"s")},e.preroll.prerollError=function(r){e.preroll.exitPreroll()},e.currentSrc()&&(e.preroll.shouldPlayPreroll()?e.trigger("adsready"):e.trigger("adscanceled"))}(this,l.default.mergeOptions(i,e))};return t("preroll",a),a.VERSION="2.0.0",a}));
